<?xml version="1.0" standalone="no"?>
<!DOCTYPE entity PUBLIC "-//UC Berkeley//DTD MoML 1//EN"
    "http://ptolemy.eecs.berkeley.edu/xml/dtd/MoML_1.dtd">
<entity name="WebServerDE" class="ptolemy.actor.TypedCompositeActor">
    <property name="_createdBy" class="ptolemy.kernel.attributes.VersionAttribute" value="11.0.devel">
    </property>
    <property name="PN Director" class="ptolemy.domains.pn.kernel.PNDirector">
        <property name="_location" class="ptolemy.kernel.util.Location" value="{85, 45}">
        </property>
    </property>
    <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={32, 19, 928, 641}, maximized=false}">
    </property>
    <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[700, 524]">
    </property>
    <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0">
    </property>
    <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{372.0, 269.181640625}">
    </property>
    <property name="Annotation" class="ptolemy.vergil.kernel.attributes.TextAttribute">
        <property name="text" class="ptolemy.kernel.util.StringAttribute" value="This contains the web server model.&#10;Set the firingCountLimit to 1, because&#10;each firing of this actor is a complete&#10;execution of the inside model.">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[50.0, 215.0]">
        </property>
    </property>
    <property name="Annotation2" class="ptolemy.vergil.kernel.attributes.TextAttribute">
        <property name="text" class="ptolemy.kernel.util.StringAttribute" value="Test a web server and client.&#10;Each is executed in its own thread.">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[160.0, 20.0]">
        </property>
    </property>
    <property name="Annotation3" class="ptolemy.vergil.kernel.attributes.TextAttribute">
        <property name="textColor" class="ptolemy.actor.gui.ColorAttribute" value="{1.0,0.0,0.2,1.0}">
        </property>
        <property name="text" class="ptolemy.kernel.util.StringAttribute" value="FIXME: The WebServer does not immediately release the&#10;port when the execution finishes, so a second execution of&#10;this model or any other that uses the same port for HTTP&#10;will fail until some time (a minute or so) has elapsed.&#10;The model below delays completion of this top-level model&#10;to give the server time to reliquish the port.">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[50.0, 320.0]">
        </property>
    </property>
    <property name="Annotation4" class="ptolemy.vergil.kernel.attributes.TextAttribute">
        <property name="text" class="ptolemy.kernel.util.StringAttribute" value="This contains the client model.&#10;Set the firingCountLimit to 1, because&#10;each firing of this actor is a complete&#10;execution of the inside model.&#10;This model emulates a browser by&#10;first issuing an HTTP get and then&#10;a post.">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[425.0, 200.0]">
        </property>
    </property>
    <property name="port" class="ptolemy.data.expr.Parameter" value="8078">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[425.0, 85.0]">
        </property>
    </property>
    <property name="Annotation6" class="ptolemy.vergil.kernel.attributes.TextAttribute">
        <property name="text" class="ptolemy.kernel.util.StringAttribute" value="port is set dynamically in RunCompositeActor&#10;The parameter is declared at the top-level &#10;so RunCompositeActor2 can access it">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[420.0, 15.0]">
        </property>
    </property>
    <entity name="RunCompositeActor" class="ptolemy.actor.lib.hoc.RunCompositeActor">
        <property name="firingCountLimit" class="ptolemy.data.expr.Parameter" value="1">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[115.0, 175.0]">
        </property>
        <property name="Annotation" class="ptolemy.vergil.kernel.attributes.TextAttribute">
            <property name="text" class="ptolemy.kernel.util.StringAttribute" value="This model launches a web server and provides a service&#10;available at http://localhost:8078/ptolemnizer.&#10;Run the model and navigate to that location&#10;(or click on this comment).">
            </property>
            <property name="LiveLink" class="ptolemy.actor.gui.LiveLink" value="$link">
                <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
                </property>
                <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                    <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                    </property>
                </property>
                <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                    <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">LL</text>
      </svg>
    </configure>
                </property>
                <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="{440, 335}">
                </property>
            </property>
            <property name="_location" class="ptolemy.kernel.util.RelativeLocation" value="[170.0, -5.0]">
            </property>
        </property>
        <property name="DE Director" class="ptolemy.domains.de.kernel.DEDirector">
            <property name="stopWhenQueueIsEmpty" class="ptolemy.data.expr.Parameter" value="false">
            </property>
            <property name="synchronizeToRealTime" class="ptolemy.data.expr.Parameter" value="true">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[110.0, 30.0]">
            </property>
        </property>
        <property name="WebServer" class="org.ptolemy.ptango.lib.WebServer">
            <property name="preferredPort" class="ptolemy.data.expr.Parameter" value="">
            </property>
            <property name="resourcePath" class="ptolemy.data.expr.StringParameter" value="/files">
            </property>
            <property name="resourceLocation" class="ptolemy.data.expr.FileParameter" value="$PTII/org/ptolemy/ptango/demo/files">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[630.0, 45.0]">
            </property>
            <property name="resourceAttribute2" class="ptolemy.data.expr.FileParameter" value="$PTII/doc/img">
            </property>
        </property>
        <property name="Annotation2" class="ptolemy.vergil.kernel.attributes.TextAttribute">
            <property name="text" class="ptolemy.kernel.util.StringAttribute" value="The upper loop handles HTTP get requests&#10;by posting the web page given in the FileReader.&#10;The HTML file it serves is specified by a path&#10;relative to the location of this demo.">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[335.0, 140.0]">
            </property>
        </property>
        <property name="Annotation3" class="ptolemy.vergil.kernel.attributes.TextAttribute">
            <property name="text" class="ptolemy.kernel.util.StringAttribute" value="The lower loop handles HTTP post requests&#10;by extracting text from post, Ptolemnizing it,&#10;and returning the result in a web page.">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[340.0, 225.0]">
            </property>
        </property>
        <property name="enableBackwardTypeInference" class="ptolemy.data.expr.Parameter" value="true">
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                </property>
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[345.0, 120.0]">
            </property>
        </property>
        <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={72, 9, 990, 759}, maximized=false}">
        </property>
        <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[762, 642]">
        </property>
        <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0">
        </property>
        <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{371.0, 311.0}">
        </property>
        <property name="link" class="ptolemy.data.expr.Parameter" value="&quot;http://localhost:&quot; + port + &quot;/ptolemnizer#in_browser&quot;">
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                </property>
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[345.0, 100.0]">
            </property>
        </property>
        <entity name="HttpActor" class="org.ptolemy.ptango.lib.HttpActor">
            <property name="path" class="ptolemy.data.expr.StringParameter" value="/ptolemnizer/*">
            </property>
            <property name="timeout" class="ptolemy.data.expr.Parameter" value="30000L">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[90.0, 170.0]">
            </property>
            <port name="getParameters" class="ptolemy.actor.TypedIOPort">
                <property name="output"/>
                <property name="_type" class="ptolemy.actor.TypeAttribute" value="general">
                </property>
            </port>
            <port name="getCookies" class="ptolemy.actor.TypedIOPort">
                <property name="output"/>
                <property name="_type" class="ptolemy.actor.TypeAttribute" value="general">
                </property>
            </port>
            <port name="postCookies" class="ptolemy.actor.TypedIOPort">
                <property name="output"/>
                <property name="_type" class="ptolemy.actor.TypeAttribute" value="general">
                </property>
            </port>
        </entity>
        <entity name="FileReader" class="ptolemy.actor.lib.io.FileReader">
            <property name="fileOrURL" class="ptolemy.data.expr.FileParameter" value="$PTII/org/ptolemy/ptango/demo/WebServerDE/pages/index.html">
            </property>
            <doc>Read an entire file and output as a string</doc>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[260.0, 150.0]">
            </property>
        </entity>
        <entity name="RecordDisassembler" class="ptolemy.actor.lib.RecordDisassembler">
            <property name="_location" class="ptolemy.kernel.util.Location" value="[83.0, 280.0]">
            </property>
            <port name="text" class="ptolemy.actor.TypedIOPort">
                <property name="output"/>
                <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
                </property>
            </port>
        </entity>
        <entity name="Ptolemnizer" class="ptolemy.actor.lib.python.PythonScript">
            <property name="script" class="ptolemy.kernel.util.StringAttribute" value="from ptolemy.data import StringToken&#10;class Main :&#10;  &quot;ptolemizer&quot;&#10;  def fire(self) :&#10;    # read input, compute, send output&#10;    t = self.in.get(0)&#10;    s = t.stringValue()&#10;    s = self.ptolemize(s)&#10;    t = StringToken(s)&#10;    self.out.broadcast(t)&#10;    return&#10;&#10;  def ptolemize(self, s) :&#10;    l = list(s)&#10;    length = len(l)&#10;    if length == 0 :&#10;      return ''&#10;    if length == 1 :&#10;      if l[0] == 't' :&#10;        return 'pt'&#10;      else :&#10;        return l[0]&#10;    if l[0] == 't' and l[1] != 'h' :&#10;      l[0] = 'pt'&#10;    i = 1&#10;    while i &lt; length - 1 :&#10;      if l[i-1] == ' ' and l[i] == 't' and l[i+1] != 'h' :&#10;        l[i] = 'pt'&#10;      i = i + 1&#10;    if l[-2] == ' ' and l[-1] == 't' :&#10;      l[-1] = 'pt'&#10;    return reduce(lambda x,y: x+y, l, '')">
                <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                </property>
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.TextEditorConfigureFactory">
                <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="script">
                </property>
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[238.0, 350.0]">
            </property>
            <port name="in" class="ptolemy.actor.TypedIOPort">
                <property name="input"/>
                <property name="_type" class="ptolemy.actor.TypeAttribute" value="string">
                </property>
            </port>
            <port name="out" class="ptolemy.actor.TypedIOPort">
                <property name="output"/>
            </port>
        </entity>
        <entity name="StringConst" class="ptolemy.actor.lib.StringConst">
            <property name="value" class="ptolemy.data.expr.Parameter" value="&lt;img src=&quot;/img/Icon.gif&quot;/&gt;&lt;h1&gt;Ptolemnized Text&lt;/h1&gt;">
            </property>
            <doc>Create a constant sequence with a string value.</doc>
            <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
                <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="value">
                </property>
                <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="80">
                </property>
                <property name="displayHeight" class="ptolemy.data.expr.Parameter" value="10">
                </property>
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[378.0, 300.0]">
            </property>
        </entity>
        <entity name="AddSubtract" class="ptolemy.actor.lib.AddSubtract">
            <property name="_location" class="ptolemy.kernel.util.Location" value="[480.0, 370.0]">
            </property>
        </entity>
        <entity name="StringConst2" class="ptolemy.actor.lib.StringConst">
            <property name="value" class="ptolemy.data.expr.Parameter" value="&lt;p&gt;&lt;img src=&quot;/files/PtolemyIISmallIcon.gif&quot;/&gt;">
            </property>
            <doc>Create a constant sequence with a string value.</doc>
            <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
                <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="value">
                </property>
                <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="80">
                </property>
                <property name="displayHeight" class="ptolemy.data.expr.Parameter" value="10">
                </property>
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[278.0, 400.0]">
            </property>
        </entity>
        <entity name="StringConst3" class="ptolemy.actor.lib.StringConst">
            <property name="value" class="ptolemy.data.expr.Parameter" value="&lt;p&gt;&lt;img src=&quot;/files/PtolemyIISmall.gif&quot;/&gt;">
            </property>
            <doc>Create a constant sequence with a string value.</doc>
            <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
                <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="value">
                </property>
                <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="80">
                </property>
                <property name="displayHeight" class="ptolemy.data.expr.Parameter" value="10">
                </property>
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[300.0, 450.0]">
            </property>
        </entity>
        <entity name="MicrostepDelay" class="ptolemy.actor.lib.MicrostepDelay">
            <property name="_location" class="ptolemy.kernel.util.Location" value="[75.0, 575.0]">
            </property>
        </entity>
        <entity name="Stop" class="ptolemy.actor.lib.Stop">
            <property name="_location" class="ptolemy.kernel.util.Location" value="[265.0, 575.0]">
            </property>
        </entity>
        <entity name="Const" class="ptolemy.actor.lib.Const">
            <property name="value" class="ptolemy.data.expr.Parameter" value="true">
            </property>
            <doc>Create a constant sequence.</doc>
            <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
                <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="value">
                </property>
                <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="60">
                </property>
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="{190, 575}">
            </property>
        </entity>
        <entity name="MicrostepDelay2" class="ptolemy.actor.lib.MicrostepDelay">
            <property name="_location" class="ptolemy.kernel.util.Location" value="[105.0, 105.0]">
            </property>
            <property name="_flipPortsHorizontal" class="ptolemy.data.expr.Parameter" value="true">
            </property>
        </entity>
        <entity name="MicrostepDelay3" class="ptolemy.actor.lib.MicrostepDelay">
            <property name="_location" class="ptolemy.kernel.util.Location" value="[160.0, 510.0]">
            </property>
            <property name="_flipPortsHorizontal" class="ptolemy.data.expr.Parameter" value="true">
            </property>
        </entity>
        <entity name="Init" class="ptolemy.actor.TypedCompositeActor">
            <property name="_location" class="ptolemy.kernel.util.Location" value="[540.0, 55.0]">
            </property>
            <entity name="SingleEvent" class="ptolemy.actor.lib.SingleEvent">
                <property name="_location" class="ptolemy.kernel.util.Location" value="[45.0, 55.0]">
                </property>
            </entity>
            <entity name="Ramp" class="ptolemy.actor.lib.Ramp">
                <property name="init" class="ptolemy.actor.parameters.PortParameter" value="WebServer.getAttribute(&quot;deployedPort&quot;).getToken().intValue()">
                </property>
                <property name="step" class="ptolemy.actor.parameters.PortParameter" value="0">
                </property>
                <doc>Create a sequence of tokens with increasing value</doc>
                <property name="_location" class="ptolemy.kernel.util.Location" value="{155, 65}">
                </property>
            </entity>
            <entity name="SetVariable" class="ptolemy.actor.lib.SetVariable">
                <property name="variableName" class="ptolemy.kernel.util.StringAttribute" value="port">
                </property>
                <property name="delayed" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
                    <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="variableName">
                    </property>
                    <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="40">
                    </property>
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[250.0, 65.0]">
                </property>
            </entity>
            <entity name="SetVariable2" class="ptolemy.actor.lib.SetVariable">
                <property name="variableName" class="ptolemy.kernel.util.StringAttribute" value="link">
                </property>
                <property name="delayed" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
                    <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="variableName">
                    </property>
                    <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="40">
                    </property>
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[390.0, 135.0]">
                </property>
            </entity>
            <entity name="Expression" class="ptolemy.actor.lib.Expression">
                <property name="expression" class="ptolemy.kernel.util.StringAttribute" value="&quot;http://localhost:&quot; + port + &quot;/ptolemnizer#in_browser&quot;">
                </property>
                <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
                    <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="expression">
                    </property>
                    <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="60">
                    </property>
                    <property name="displayHeight" class="ptolemy.data.expr.Parameter" value="10">
                    </property>
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[190.0, 135.0]">
                </property>
                <port name="trigger" class="ptolemy.actor.TypedIOPort">
                    <property name="input"/>
                    <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
                    </property>
                </port>
            </entity>
            <relation name="relation" class="ptolemy.actor.TypedIORelation">
            </relation>
            <relation name="relation2" class="ptolemy.actor.TypedIORelation">
            </relation>
            <relation name="relation3" class="ptolemy.actor.TypedIORelation">
            </relation>
            <relation name="relation4" class="ptolemy.actor.TypedIORelation">
            </relation>
            <link port="SingleEvent.output" relation="relation"/>
            <link port="Ramp.output" relation="relation2"/>
            <link port="Ramp.trigger" relation="relation"/>
            <link port="SetVariable.input" relation="relation2"/>
            <link port="SetVariable.output" relation="relation4"/>
            <link port="SetVariable2.input" relation="relation3"/>
            <link port="Expression.output" relation="relation3"/>
            <link port="Expression.trigger" relation="relation4"/>
        </entity>
        <relation name="relation" class="ptolemy.actor.TypedIORelation">
            <property name="color" class="ptolemy.actor.gui.ColorAttribute">
            </property>
        </relation>
        <relation name="relation2" class="ptolemy.actor.TypedIORelation">
            <property name="color" class="ptolemy.actor.gui.ColorAttribute">
            </property>
        </relation>
        <relation name="relation3" class="ptolemy.actor.TypedIORelation">
            <property name="width" class="ptolemy.data.expr.Parameter" value="-1">
            </property>
            <vertex name="vertex1" value="[128.0, 300.0]">
            </vertex>
            <property name="color" class="ptolemy.actor.gui.ColorAttribute">
            </property>
        </relation>
        <relation name="relation4" class="ptolemy.actor.TypedIORelation">
            <property name="color" class="ptolemy.actor.gui.ColorAttribute">
            </property>
        </relation>
        <relation name="relation5" class="ptolemy.actor.TypedIORelation">
            <property name="color" class="ptolemy.actor.gui.ColorAttribute">
            </property>
        </relation>
        <relation name="relation6" class="ptolemy.actor.TypedIORelation">
            <property name="color" class="ptolemy.actor.gui.ColorAttribute">
            </property>
        </relation>
        <relation name="relation7" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation8" class="ptolemy.actor.TypedIORelation">
            <vertex name="vertex1" value="[25.0, 105.0]">
            </vertex>
        </relation>
        <relation name="relation9" class="ptolemy.actor.TypedIORelation">
            <vertex name="vertex1" value="[15.0, 510.0]">
            </vertex>
        </relation>
        <relation name="relation10" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation11" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation12" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation13" class="ptolemy.actor.TypedIORelation">
        </relation>
        <link port="HttpActor.response" relation="relation8"/>
        <link port="HttpActor.response" relation="relation9"/>
        <link port="HttpActor.getRequestURI" relation="relation2"/>
        <link port="HttpActor.postParameters" relation="relation"/>
        <link port="FileReader.output" relation="relation12"/>
        <link port="FileReader.trigger" relation="relation2"/>
        <link port="RecordDisassembler.input" relation="relation"/>
        <link port="RecordDisassembler.text" relation="relation3"/>
        <link port="Ptolemnizer.in" relation="relation3"/>
        <link port="Ptolemnizer.out" relation="relation5"/>
        <link port="StringConst.output" relation="relation4"/>
        <link port="StringConst.trigger" relation="relation3"/>
        <link port="AddSubtract.plus" relation="relation4"/>
        <link port="AddSubtract.plus" relation="relation5"/>
        <link port="AddSubtract.plus" relation="relation6"/>
        <link port="AddSubtract.plus" relation="relation7"/>
        <link port="AddSubtract.output" relation="relation13"/>
        <link port="StringConst2.output" relation="relation6"/>
        <link port="StringConst2.trigger" relation="relation3"/>
        <link port="StringConst3.output" relation="relation7"/>
        <link port="StringConst3.trigger" relation="relation3"/>
        <link port="MicrostepDelay.input" relation="relation9"/>
        <link port="MicrostepDelay.output" relation="relation10"/>
        <link port="Stop.input" relation="relation11"/>
        <link port="Const.output" relation="relation11"/>
        <link port="Const.trigger" relation="relation10"/>
        <link port="MicrostepDelay2.input" relation="relation12"/>
        <link port="MicrostepDelay2.output" relation="relation8"/>
        <link port="MicrostepDelay3.input" relation="relation13"/>
        <link port="MicrostepDelay3.output" relation="relation9"/>
    </entity>
    <entity name="RunCompositeActor2" class="ptolemy.actor.lib.hoc.RunCompositeActor">
        <property name="firingCountLimit" class="ptolemy.data.expr.Parameter" value="1">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="{515.0, 175.0}">
        </property>
        <property name="DE Director" class="ptolemy.domains.de.kernel.DEDirector">
            <property name="synchronizeToRealTime" class="ptolemy.data.expr.Parameter" value="true">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[95.0, 25.0]">
            </property>
        </property>
        <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={0, 110, 1199, 641}, maximized=false}">
        </property>
        <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[700, 524]">
        </property>
        <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0">
        </property>
        <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{340.0, 252.0}">
        </property>
        <property name="Annotation" class="ptolemy.vergil.kernel.attributes.TextAttribute">
            <property name="text" class="ptolemy.kernel.util.StringAttribute" value="Need to give time for the web server to start up, so we&#10;synchronize to real time and trigger the HTTP get after 5 seconds.">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[40.0, 50.0]">
            </property>
        </property>
        <property name="annotation" class="ptolemy.kernel.util.Attribute">
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
            <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure><svg><text x="20" y="20" style="font-size:14; font-family:SansSerif; fill:blue">Strip any \r since these do not occur on all operating systems</text></svg></configure>
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure>
                <svg> 
                    <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-A-</text>
                </svg>
              </configure>
            </property>
            <property name="_controllerFactory" class="ptolemy.vergil.basic.NodeControllerFactory">
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.AnnotationEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[275.0, 235.0]">
            </property>
        </property>
        <entity name="SingleEvent" class="ptolemy.actor.lib.SingleEvent">
            <property name="time" class="ptolemy.data.expr.Parameter" value="5.0">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="{75.0, 200.0}">
            </property>
        </entity>
        <entity name="HttpPost" class="org.ptolemy.ptango.lib.HttpPost">
            <property name="url" class="ptolemy.actor.parameters.PortParameter" value="http://localhost:$port/ptolemnizer">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[625.0, 130.0]">
            </property>
        </entity>
        <entity name="Test" class="ptolemy.actor.lib.Test">
            <property name="correctValues" class="ptolemy.data.expr.Parameter" value="{&quot;&lt;!-- The input form for the WebServerDE model Copyright (c) 1997-2014 The Regents of the University of California. All rights reserved. Permission is hereby granted, without written agreement and without license or royalty fees, to use, copy, modify, and distribute this software and its documentation for any purpose, provided that the above copyright notice and the following two paragraphs appear in all copies of this software. IN NO EVENT SHALL THE UNIVERSITY OF CALIFORNIA BE LIABLE TO ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF THE UNIVERSITY OF CALIFORNIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. THE UNIVERSITY OF CALIFORNIA SPECIFICALLY DISCLAIMS ANY WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE SOFTWARE PROVIDED HEREUNDER IS ON AN \&quot;AS IS\&quot; BASIS, AND THE UNIVERSITY OF CALIFORNIA HAS NO OBLIGATION TO PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS. PT_COPYRIGHT_VERSION_2 COPYRIGHTENDKEY --&gt; &lt;!DOCTYPE html&gt;&lt;head&gt; \t&lt;meta charset=\&quot;utf-8\&quot;&gt;\t\t&lt;!-- Load jQuery and jQueryMobile script stylesheets and libraries.  \t\t Note that jQuery must come before jQueryMobile \t\t Use online version to avoid problems rendering icons.  The files are \t\t included in the repository for reference.  The local version could be used\t\t so that an internet connection is not required if testing from localhost.\t\t Both the human-readable version and the .min.js version for smaller \t\t footprint are in the repository, though the web app only needs one version \t\t to run.\t\t Note that jQuery 1.7 is available, but there are currently problems with\t\t that version and jQueryMobile.  jQuery 1.6.4 is the latest version \t\t supported. --&gt; \t\t &lt;!-- Uncomment this to get handheld look and feel\t\t \t&lt;link rel=\&quot;stylesheet\&quot; href=\&quot;http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.css\&quot; /&gt;\t&lt;script type=\&quot;text/javascript\&quot; src=\&quot;http://code.jquery.com/jquery-1.6.4.min.js\&quot;&gt;&lt;/script&gt;\t&lt;script type=\&quot;text/javascript\&quot; src=\&quot;http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.js\&quot;&gt;&lt;/script&gt;--&gt;\t&lt;title&gt; Website Ptolemnizer &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;div data-role=\&quot;page\&quot; data-theme=\&quot;c\&quot;&gt;\t&lt;div data-role=\&quot;header\&quot;&gt;\t\t&lt;h1&gt; Text Ptolemnizer &lt;/h1&gt;\t&lt;/div&gt;\t&lt;div data-role=\&quot;content\&quot;&gt;\t\t&lt;p&gt; This web service \&quot;ptolemnizes\&quot; a string by locating leading t's and \t\t replacing with pt's. &lt;/p&gt; &lt;p&gt; Please enter text to Ptolemnize: &lt;/p&gt;\t\t&lt;!-- could have an action=\&quot;suburl\&quot; in the form item to send the post to another actor. --&gt;\t\t&lt;form action=\&quot;ptolemnizer\&quot; method=\&quot;post\&quot; &gt;\t\t\t\t\t&lt;div data-role=\&quot;fieldcontain\&quot; class=\&quot;ui-hide-label\&quot;&gt;\t\t\t\t&lt;label for=\&quot;text\&quot;&gt;text:&lt;/label&gt;\t\t\t\t&lt;input type=\&quot;text\&quot; name=\&quot;text\&quot; id=\&quot;text\&quot; value=\&quot;\&quot; width=\&quot;80\&quot; placeholder=\&quot;text to tolemnize\&quot;/&gt;\t\t\t\t&lt;/br&gt;\t\t\t&lt;/div&gt;\t\t\t\t\t&lt;div&gt; &lt;p&gt; Click the button and Ptolemy will Ptolemnize the text for you! &lt;/p&gt;\t\t\t\t&lt;button type=\&quot;submit\&quot; id=\&quot;ptolemnize\&quot;&gt; Ptolemynize &lt;/button&gt;\t\t\t&lt;/div&gt;\t\t&lt;/form&gt;\t&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&quot;}">
            </property>
            <property name="trainingMode" class="ptolemy.actor.parameters.SharedParameter" value="false">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[460.0, 200.0]">
            </property>
        </entity>
        <entity name="Const" class="ptolemy.actor.lib.Const">
            <property name="value" class="ptolemy.data.expr.Parameter" value="{text=&quot;text to tolemnize&quot;}">
            </property>
            <doc>Create a constant sequence.</doc>
            <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
                <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="value">
                </property>
                <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="60">
                </property>
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[470.0, 130.0]">
            </property>
        </entity>
        <entity name="Test2" class="ptolemy.actor.lib.Test">
            <property name="correctValues" class="ptolemy.data.expr.Parameter" value="{&quot;&lt;img src=\&quot;/img/Icon.gif\&quot;/&gt;&lt;h1&gt;Ptolemnized Text&lt;/h1&gt;ptext pto ptolemnize&lt;p&gt;&lt;img src=\&quot;/files/PtolemyIISmallIcon.gif\&quot;/&gt;&lt;p&gt;&lt;img src=\&quot;/files/PtolemyIISmall.gif\&quot;/&gt;&quot;}">
            </property>
            <property name="trainingMode" class="ptolemy.actor.parameters.SharedParameter" value="false">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[855.0, 120.0]">
            </property>
        </entity>
        <entity name="HttpGet" class="org.ptolemy.ptango.lib.HttpGet">
            <property name="url" class="ptolemy.actor.parameters.PortParameter" value="http://localhost:$port/ptolemnizer">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[175.0, 200.0]">
            </property>
        </entity>
        <entity name="StringReplace" class="ptolemy.actor.lib.string.StringReplace">
            <property name="pattern" class="ptolemy.actor.parameters.PortParameter" value="\r">
            </property>
            <property name="stringToEdit" class="ptolemy.actor.parameters.PortParameter" value="&lt;!-- The input form for the WebServerDE model Copyright (c) 1997-2014 The Regents of the University of California. All rights reserved. Permission is hereby granted, without written agreement and without license or royalty fees, to use, copy, modify, and distribute this software and its documentation for any purpose, provided that the above copyright notice and the following two paragraphs appear in all copies of this software. IN NO EVENT SHALL THE UNIVERSITY OF CALIFORNIA BE LIABLE TO ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF THE UNIVERSITY OF CALIFORNIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. THE UNIVERSITY OF CALIFORNIA SPECIFICALLY DISCLAIMS ANY WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE SOFTWARE PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND THE UNIVERSITY OF CALIFORNIA HAS NO OBLIGATION TO PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS. PT_COPYRIGHT_VERSION_2 COPYRIGHTENDKEY --&gt; &lt;!DOCTYPE html&gt;&lt;head&gt; 	&lt;meta charset=&quot;utf-8&quot;&gt;		&lt;!-- Load jQuery and jQueryMobile script stylesheets and libraries.  		 Note that jQuery must come before jQueryMobile 		 Use online version to avoid problems rendering icons.  The files are 		 included in the repository for reference.  The local version could be used		 so that an internet connection is not required if testing from localhost.		 Both the human-readable version and the .min.js version for smaller 		 footprint are in the repository, though the web app only needs one version 		 to run.		 Note that jQuery 1.7 is available, but there are currently problems with		 that version and jQueryMobile.  jQuery 1.6.4 is the latest version 		 supported. --&gt; 		 &lt;!-- Uncomment this to get handheld look and feel		 	&lt;link rel=&quot;stylesheet&quot; href=&quot;http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.css&quot; /&gt;	&lt;script type=&quot;text/javascript&quot; src=&quot;http://code.jquery.com/jquery-1.6.4.min.js&quot;&gt;&lt;/script&gt;	&lt;script type=&quot;text/javascript&quot; src=&quot;http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.js&quot;&gt;&lt;/script&gt;--&gt;	&lt;title&gt; Website Ptolemnizer &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;div data-role=&quot;page&quot; data-theme=&quot;c&quot;&gt;	&lt;div data-role=&quot;header&quot;&gt;		&lt;h1&gt; Text Ptolemnizer &lt;/h1&gt;	&lt;/div&gt;	&lt;div data-role=&quot;content&quot;&gt;		&lt;p&gt; This web service &quot;ptolemnizes&quot; a string by locating leading t's and 		 replacing with pt's. &lt;/p&gt; &lt;p&gt; Please enter text to Ptolemnize: &lt;/p&gt;		&lt;!-- could have an action=&quot;suburl&quot; in the form item to send the post to another actor. --&gt;		&lt;form action=&quot;ptolemnizer&quot; method=&quot;post&quot; &gt;					&lt;div data-role=&quot;fieldcontain&quot; class=&quot;ui-hide-label&quot;&gt;				&lt;label for=&quot;text&quot;&gt;text:&lt;/label&gt;				&lt;input type=&quot;text&quot; name=&quot;text&quot; id=&quot;text&quot; value=&quot;&quot; width=&quot;80&quot; placeholder=&quot;text to tolemnize&quot;/&gt;				&lt;/br&gt;			&lt;/div&gt;					&lt;div&gt; &lt;p&gt; Click the button and Ptolemy will Ptolemnize the text for you! &lt;/p&gt;				&lt;button type=&quot;submit&quot; id=&quot;ptolemnize&quot;&gt; Ptolemynize &lt;/button&gt;			&lt;/div&gt;		&lt;/form&gt;	&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;">
            </property>
            <doc>Replace the patterns that match a regular expression</doc>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[330.0, 200.0]">
            </property>
        </entity>
        <entity name="StringReplace2" class="ptolemy.actor.lib.string.StringReplace">
            <property name="pattern" class="ptolemy.actor.parameters.PortParameter" value="\r">
            </property>
            <property name="stringToEdit" class="ptolemy.actor.parameters.PortParameter" value="&lt;img src=&quot;/img/Icon.gif&quot;/&gt;&lt;h1&gt;Ptolemnized Text&lt;/h1&gt;ptext pto ptolemnize&lt;p&gt;&lt;img src=&quot;/files/PtolemyIISmallIcon.gif&quot;/&gt;&lt;p&gt;&lt;img src=&quot;/files/PtolemyIISmall.gif&quot;/&gt;">
            </property>
            <doc>Replace the patterns that match a regular expression</doc>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[750.0, 120.0]">
            </property>
        </entity>
        <relation name="relation3" class="ptolemy.actor.TypedIORelation">
            <property name="width" class="ptolemy.data.expr.Parameter" value="-1">
            </property>
            <vertex name="vertex1" value="{250.0, 210.0}">
            </vertex>
            <property name="_layoutHint" class="ptolemy.vergil.actor.LayoutHint" value="{ { head={id=&quot;relation3.vertex1&quot;,x=250.0,y=210.0}, tail={id=&quot;Test.input&quot;,x=300.0,y=210.0}, points={} },{ head={id=&quot;FileReader.output&quot;,x=195.0,y=210.0}, tail={id=&quot;relation3.vertex1&quot;,x=250.0,y=210.0}, points={} },{ head={id=&quot;Const.trigger&quot;,x=375.0,y=145.0}, tail={id=&quot;relation3.vertex1&quot;,x=250.0,y=210.0}, points={250.0,145.0} } }">
            </property>
        </relation>
        <relation name="relation2" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation5" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation6" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation4" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation" class="ptolemy.actor.TypedIORelation">
            <vertex name="vertex1" value="[400.0, 200.0]">
            </vertex>
        </relation>
        <link port="SingleEvent.output" relation="relation5"/>
        <link port="HttpPost.input" relation="relation2"/>
        <link port="HttpPost.output" relation="relation6"/>
        <link port="Test.input" relation="relation"/>
        <link port="Const.output" relation="relation2"/>
        <link port="Const.trigger" relation="relation"/>
        <link port="Test2.input" relation="relation4"/>
        <link port="HttpGet.output" relation="relation3"/>
        <link port="HttpGet.trigger" relation="relation5"/>
        <link port="StringReplace.stringToEdit" relation="relation3"/>
        <link port="StringReplace.output" relation="relation"/>
        <link port="StringReplace2.stringToEdit" relation="relation6"/>
        <link port="StringReplace2.output" relation="relation4"/>
    </entity>
    <entity name="RunCompositeActor3" class="ptolemy.actor.lib.hoc.RunCompositeActor">
        <property name="firingCountLimit" class="ptolemy.data.expr.Parameter" value="1">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[90.0, 465.0]">
        </property>
        <property name="DE Director" class="ptolemy.domains.de.kernel.DEDirector">
            <property name="synchronizeToRealTime" class="ptolemy.data.expr.Parameter" value="true">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[100.0, 65.0]">
            </property>
        </property>
        <property name="Annotation" class="ptolemy.vergil.kernel.attributes.TextAttribute">
            <property name="text" class="ptolemy.kernel.util.StringAttribute" value="To give time for the web server to relinquish the port after exiting,&#10;synchronize to real time and trigger an event after some time.&#10;Estimating that one minute is sufficient.">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[45.0, 90.0]">
            </property>
        </property>
        <entity name="SingleEvent" class="ptolemy.actor.lib.SingleEvent">
            <property name="time" class="ptolemy.data.expr.Parameter" value="60.0">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[80.0, 240.0]">
            </property>
        </entity>
        <entity name="Test" class="ptolemy.actor.lib.Test">
            <property name="correctValues" class="ptolemy.data.expr.Parameter" value="{}">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="{220.0, 240.0}">
            </property>
        </entity>
        <relation name="relation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <link port="SingleEvent.output" relation="relation"/>
        <link port="Test.input" relation="relation"/>
    </entity>
</entity>
